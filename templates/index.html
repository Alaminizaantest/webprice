<!DOCTYPE html>
<html>
<head>
    <title>Realtime Coin Data</title>
</head>
<body>
    <h1>Realtime Coin Data</h1>
    <table>
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Last Price</th>
                <th>Volume</th>
                <th>Change</th>
            </tr>
        </thead>
        <tbody>
            {% for coin in coin_data %}
            <tr>
                <td>{{ coin.symbol }}</td>
                <td>{{ coin.last_price }}</td>
                <td>{{ coin.volume }}</td>
                <td>{{ coin.change }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <script>
        var source = new EventSource("/stream");
        source.onmessage = function(event) {
            var trades = JSON.parse(event.data);
            for (var symbol in trades) {
                var trade = trades[symbol];
                var row = document.querySelector("tr[data-symbol='" + symbol + "']");
                if (row) {
                    row.querySelector(".last-price").innerText = trade.price;
                    row.querySelector(".volume").innerText = trade.amount;
                }
            }
        }
    </script>
</body>
</html>
