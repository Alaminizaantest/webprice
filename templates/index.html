<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime Crypto Prices</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Realtime Crypto Prices</h1>
    <table>
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Last Price</th>
                <th>Volume</th>
                <th>Change (24h)</th>
            </tr>
        </thead>
        <tbody id="coin_data">
        </tbody>
    </table>

    <script>
        const socket = new WebSocket('wss://arbitrage.osc-fr1.scalingo.io/stream');
        socket.onmessage = function (event) {
            const data = JSON.parse(event.data);
            updateCoinData(data);
        }

        function updateCoinData(data) {
            const symbol = data.symbol;
            const lastPrice = data.last_price.toFixed(8);
            const volume = data.volume.toFixed(2);
            const change = data.change.toFixed(2);
            const row = `<tr>
                            <td>${symbol}</td>
                            <td>${lastPrice}</td>
                            <td>${volume}</td>
                            <td>${change}%</td>
                        </tr>`;
            const existingRow = $(`#coin_data tr#${symbol}`);
            if (existingRow.length > 0) {
                existingRow.replaceWith(row);
            } else {
                $('#coin_data').append(row);
            }
        }
    </script>
</body>
</html>
